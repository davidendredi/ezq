<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
  </head>
  <body>
    <p>This is a short demo of socket connection & communication with socket.io</p>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      // open connection
      let socket = io();
      socket.on('connect', () => {
        console.log("Connected to server.");
        
        
        socket.emit('registerDevice', localStorage.getItem('deviceID'), (newUid) => {
          localStorage.setItem('deviceID', newUid);
        });


      });

      socket.on('disconnect', () => {
        console.log("Disconnected from server.");
      });

      socket.on('command', (value, approveCommand) => {
        // TODO: React to the command from the server (see command catalog)
        console.log(value);
        // Callback at the end. This way, the server knows if and when the client has handeled the command.
        approveCommand();
      });
    </script>
  </body>
</html>